# Firebase Authentication ‚Äî React Native Interview Explanation

---

## What is Firebase Authentication?

**Firebase Authentication (Firebase Auth)** is a backend service provided by Google that makes it easy to manage user authentication in apps. It supports multiple sign-in providers (Email/Password, Phone, Google, Facebook, Apple, etc.) and provides secure token-based authentication without requiring your own backend.

For React Native, Firebase Auth is typically used through:

- **react-native-firebase** (modular SDK, recommended)
  - `@react-native-firebase/auth`
- OR **Firebase JS SDK** (not recommended for production because of performance issues)

---

## ‚úÖ Core Concepts

### 1. User Authentication Providers

Firebase supports:

- **Email/Password**
- **Phone number OTP**
- **OAuth:** Google, Facebook, Apple, GitHub, Microsoft
- **Anonymous auth** (temporary guest account)
- **Custom token auth** (if you have your own backend)

---

### 2. Authentication State

Firebase manages the user session automatically.

You listen to authentication changes with:

```javascript
import auth from '@react-native-firebase/auth';

const unsubscribe = auth().onAuthStateChanged((user) => {
  if (user) {
    // User logged in
  } else {
    // User logged out
  }
});
```

This is used to implement **protected routes, splash screens, and auto-login**.

---

### 3. JWT Tokens

Firebase Auth provides:

- **ID token (JWT)** ‚Üí who the user is
- **Refresh token** ‚Üí gets new ID tokens automatically

- Automatically refreshed by Firebase SDK
- You don't need to manage token refresh manually.

---

## üîê Common Authentication Flows in React Native

### 1. Email/Password Sign Up

```javascript
auth().createUserWithEmailAndPassword(email, password);
```

### 2. Email/Password Login

```javascript
auth().signInWithEmailAndPassword(email, password);
```

### 3. Sign Out

```javascript
auth().signOut();
```

### 4. Phone Auth (OTP)

```javascript
const confirmation = await auth().signInWithPhoneNumber(phoneNumber);
await confirmation.confirm(code);
```

Uses device verification + SMS OTP.

---

### 5. Google Sign-In

Requires:

- `react-native-google-signin`

Linking Google credentials to Firebase:

```javascript
const { idToken } = await GoogleSignin.signIn();
const googleCredential = auth.GoogleAuthProvider.credential(idToken);
auth().signInWithCredential(googleCredential);
```

---

## üß† How Firebase Auth integrates with React Navigation

Use `onAuthStateChanged()` inside a global provider:

```javascript
const [user, setUser] = useState(null);

useEffect(() => {
  const unsubscribe = auth().onAuthStateChanged(setUser);
  return unsubscribe;
}, []);
```

Then show either:

- **AuthStack** (Login, Signup)
- **AppStack** (protected screens)

---

## üîê Protected Routes Example

```javascript
return (
  <NavigationContainer>
    {user ? <AppStack /> : <AuthStack />}
  </NavigationContainer>
);
```

---

## üìÅ Storing User Data (Firestore + Auth)

When a user signs up:

1. Create Firebase Auth user
2. Store additional details in Firestore:

```javascript
await firestore().collection('users').doc(user.uid).set({
  name,
  email: user.email,
  createdAt: firestore.FieldValue.serverTimestamp(),
});
```

---

## üõ°Ô∏è Security (interview points)

Mention these in interviews:

### 1. Firebase Auth alone is not enough

- You must add **Firestore Security Rules**.

### 2. Use HTTPS-Callable Functions for sensitive operations

### 3. Never store passwords manually

- Firebase hashes passwords using **bcrypt** automatically.

### 4. Use Firebase App Check

- Prevents abuse by verifying device/app integrity.

---

## ‚ö†Ô∏è Common Interview Mistakes

Avoid saying:

- ‚ùå "Firebase stores user sessions on the device."

  - ‚úî Sessions are managed through tokens and refreshed automatically.

- ‚ùå "Password resets happen automatically."
  - ‚úî You must trigger it:

```javascript
auth().sendPasswordResetEmail(email);
```

---

## üí¨ Common Interview Questions

### 1. How do you persist login state in React Native?

Through `onAuthStateChanged` ‚Äî Firebase restores user state automatically on app startup.

---

### 2. What happens if token expires?

Firebase SDK refreshes it automatically using the refresh token.

---

### 3. How do you do Google Sign-In on iOS?

1. Configure **reversed client ID** in Info.plist
2. Use Google Sign-In library
3. Pass returned ID token to Firebase

---

### 4. How do you secure Firestore data?

Using **security rules** based on `request.auth.uid`.

---

### 5. How do you handle logout + cleanup?

Clear Redux/Zustand states + remove listeners.

---

## üéØ Short Interview Answer (Memorize This)

> "Firebase Auth provides easy, secure user authentication for React Native apps. It supports multiple login providers and manages JWT tokens automatically. I typically use `@react-native-firebase/auth`, listen to `onAuthStateChanged()` to handle login state, and use React Navigation to show protected screens. For social logins like Google/Apple, I get the provider token, convert it to a Firebase credential, and sign in with `signInWithCredential`. I also enforce Firestore security rules to protect user data."
