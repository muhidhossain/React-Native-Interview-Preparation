# OTP-based Authentication in React Native

---

## ✅ What is OTP-based Authentication?

**OTP (One-Time Password)** authentication is a **passwordless** or **multi-factor authentication** method where the backend sends a temporary code (OTP) to the user's phone number or email, and the user verifies it to log in or register.

The OTP is:

- **Short-lived** (usually 30–300 seconds)
- **Single-use**
- **User-specific**

---

## ✅ Typical OTP Auth Flow (Mobile App)

### 1️⃣ User enters identifier

- Phone number or email
- Example: `+8801XXXXXXXXX`

### 2️⃣ App requests OTP

```http
POST /auth/send-otp
{ phone: "+8801XXXXXXXXX" }
```

### 3️⃣ Backend generates OTP

- Random **4–6 digit** code
- Stores **hashed OTP** with:
  - Expiry time
  - Attempt count
- Sends OTP via:
  - **SMS** (Twilio, AWS SNS)
  - **Email**

### 4️⃣ User enters OTP

- Shown in UI (custom input or auto-read SMS on Android)

### 5️⃣ App verifies OTP

```http
POST /auth/verify-otp
{ phone: "...", otp: "123456" }
```

### 6️⃣ Backend validates OTP

If valid:

- Marks user authenticated
- Issues auth tokens
  - **Access Token** (JWT)
  - **Refresh Token**

### 7️⃣ Tokens stored securely on device

- Usually in **Secure Storage**

---

## ✅ OTP Auth Architecture (Interview Diagram)

```
User → React Native App → API
            ↓
        Send OTP
            ↓
      SMS / Email Service
            ↓
         User enters OTP
            ↓
     API verifies OTP
            ↓
      JWT / Session created
```

---

## ✅ OTP vs Password Authentication

| Feature          | OTP Auth              | Password Auth      |
| ---------------- | --------------------- | ------------------ |
| User experience  | ✅ Simple             | ❌ Complex         |
| Password storage | ✅ None               | ❌ Required        |
| Security         | ✅ High (short-lived) | ❌ Depends on user |
| Phishing risk    | ✅ Lower              | ❌ Higher          |
| Offline login    | ❌ No                 | ✅ Possible        |

---

## ✅ OTP Implementation in React Native

### Frontend responsibilities

- Phone/email input screen
- OTP input screen
- Countdown timer
- Resend OTP logic
- Error handling (expired, invalid)

### Example OTP input

```javascript
<TextInput
  keyboardType="number-pad"
  maxLength={6}
  value={otp}
  onChangeText={setOtp}
/>
```

### Auto OTP read (Android)

- Using **SMS Retriever API**
- Libraries like:
  - `react-native-otp-verify`

---

## ✅ Secure Token Storage (Post-OTP)

After OTP verification:

**Store tokens using:**

- `expo-secure-store`
- `react-native-keychain`

❌ **Avoid:**

- AsyncStorage
- Plain text storage

---

## ✅ Security Best Practices (Interview Gold Points ⭐)

- ✅ Rate-limit OTP requests
- ✅ Add OTP expiry (30–120 seconds)
- ✅ Limit verification attempts
- ✅ Hash OTPs in backend
- ✅ Use HTTPS always
- ✅ Clear OTP input on failure
- ✅ Lock user after multiple failures

---

## ✅ Common OTP Edge Cases

| Scenario          | Handling                  |
| ----------------- | ------------------------- |
| OTP expired       | Show resend option        |
| Wrong OTP         | Show error + retry limit  |
| Multiple requests | Throttle / cooldown       |
| SIM swap          | Device-based verification |
| No SMS received   | Fallback to email         |

---

## ✅ OTP Variants

- **SMS OTP** (most common)
- **Email OTP**
- **TOTP** (Google Authenticator)
- **Magic link + OTP**
- **OTP + Password** (2FA)

---

## ✅ Interview One-Line Summary

> "OTP-based authentication is a passwordless login mechanism where a short-lived code is sent to the user's phone or email, verified by the backend, and followed by secure token-based authentication on the client."
