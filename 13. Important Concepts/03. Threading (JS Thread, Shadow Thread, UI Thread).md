# Threading in React Native (JS Thread, Shadow Thread, UI Thread)

React Native runs your app across multiple threads, each with a different responsibility. Understanding this is crucial for performance, debugging, and optimizing animations or heavy tasks.

## ğŸ§µ 1. JS Thread

**What it does**

- Runs your JavaScript code (React components, business logic, state updates, API calls).
- Handles gesture callbacks, timers, and navigation events.
- Calculates what the UI should look like next (Virtual DOM â†’ UI changes).

**Key points**

- Single-threaded (like normal JavaScript).
- If the JS thread is blocked, your app feels laggy â€” button presses don't work, screens freeze.
- Expensive tasks (loops, JSON parsing, heavy calculations) should not run here.

**Interview tip**

> If the JS thread is busy, the UI does not update even if the UI thread is free.

---

## âš™ï¸ 2. Shadow Thread

**What it does**

- Runs React Native's internal layout engine: **Yoga**.
- Converts your React Native layout (Flexbox styles) into concrete measurements (width, height, x, y).
- Works between the JS thread and the UI thread.

**Key points**

- Computes layout asynchronously so the JS thread doesn't freeze.
- Helps React Native generate a final layout tree before sending it to the UI thread.

**Interview tip**

> Shadow thread = layout calculation thread using Yoga.

---

## ğŸ¨ 3. UI Thread (Main Thread)

**What it does**

- Handles actual rendering on the screen.
- Draws:
  - Views
  - Animations
  - Images
  - Gestures
- Also manages native components of iOS/Android.

**Key points**

- Must always remain free and responsive.
- If the UI thread is blocked â†’ app becomes visually stuck (UI freeze).

**Examples of UI-thread tasks**

- Updating a View's position/opacity
- Processing touch gestures
- Running native animations

---

## ğŸ” How They Work Together (Simple Flow)

**1ï¸âƒ£ JS Thread**
React code updates â†’ produces layout instructions

**2ï¸âƒ£ Shadow Thread**
Yoga calculates layout

**3ï¸âƒ£ UI Thread**
Draws updates on the screen

---

## ğŸ§¨ Common Performance Issues Related to Threads

### âŒ JS thread blocked

- Heavy loops
- Large JSON parsing
- Not debouncing expensive events

**Result:** Touch events delayed, navigation feels slow.

### âŒ UI thread blocked

- Large images
- Heavy native animations
- Poorly optimized lists

**Result:** Janky animations and visual glitches.

---

## âš¡ How React Native Improves This

### Reanimated 2 / 3

Runs animations on the UI thread, completely avoiding JS â†’ smooth 60fps animations.

### Hermes

Faster JS execution â†’ fewer JS thread stalls.

### Fabric (new architecture)

Reduces threading overhead and improves JS-to-native communication.

---

## ğŸ“ Interview-ready summary

**React Native uses three main threads to keep apps responsive.**

- The **JS Thread** runs JavaScript logic.
- The **Shadow Thread** calculates layout using Yoga.
- The **UI Thread** renders native views and handles gestures.

- If **JS thread blocks**, app feels unresponsive.
- If **UI thread blocks**, animations freeze.
- **Shadow thread** works in the middle to ensure efficient layout calculation.
